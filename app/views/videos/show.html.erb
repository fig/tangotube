<% content_for :meta_title, "#{primary_title(@video.display.dancer_names,
                                              @video.title,
                                              @video.display.any_song_attributes,
                                              @video.youtube_id)}" %>
<% content_for :meta_description,  "#{@video.display.any_song_attributes}" %>
<% content_for :meta_image, "https://img.youtube.com/vi/#{@video.youtube_id}/hqdefault.jpg" %>
<%= render 'shared/header' %>
<div class="video-responsive-background">
  <div class="video-responsive-container" data-controller="youtube">
    <div class="plyr__video-embed" data-youtube-target="frame">
      <iframe
        src="https://www.youtube.com/embed/<%= @video.youtube_id %>?origin=https://plyr.io&amp;iv_load_policy=3&amp;modestbranding=1&amp;playsinline=1&amp;showinfo=0&amp;rel=0&amp;enablejsapi=1"
        allowfullscreen
        allowtransparency
        allow="autoplay"
      ></iframe>
    </div>
  </div>
</div>
<%= turbo_frame_tag dom_id(@video) do %>
  <div class="video-info-container">
    <%= render partial: "videos/show/video_info_primary" %>
    <div class="video-info-container-secondary">
      <div class="video-info-details-main">
        <%= render partial: "videos/show/video_info_details" %>
      </div>
      <% if @video.song.present? %>
        <%= render partial: "videos/show/lyrics" if @video.song.lyrics.present? %>
      <% end %>
      <div class="recommended-videos-section">
        <% unless @videos_from_this_performance.empty? %>
          <h2>Videos from this Performance</h2>
          <%= render partial: "videos/show/recommended_videos", locals: { videos: @videos_from_this_performance } %>
        <% end %>
        <% unless @videos_with_same_event.empty? %>
          <h2>Videos from <%= @video.event.title %></h2>
          <%= render partial: "videos/show/recommended_videos", locals: { videos: @videos_with_same_event } %>
        <% end %>
        <% unless @videos_with_same_song.empty? %>
          <h2>Videos with <br><%= "#{@video.song.title.titleize} - #{@video.song.artist.titleize}"  %></h2>
          <%= render partial: "videos/show/recommended_videos", locals: { videos: @videos_with_same_song } %>
        <% end %>
        <% unless @videos_with_same_channel.empty? %>
          <h2>Videos from <%= @video.channel.title %></h2>
          <%= render partial: "videos/show/recommended_videos", locals: { videos: @videos_with_same_channel } %>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
